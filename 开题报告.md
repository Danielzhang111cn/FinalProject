# 机器学习工程师纳米学位

## 报告人/时间
何龙

2018-09-25

## 开题报告
2~3页

### 领域背景
1~2段

在本节中，简要介绍项目提出的域的背景信息。应包括与项目有关的历史信息。应该清楚的是，或者为什么域中的问题能够或应该被解决。相关学术研究应适当引用在这一部分，包括为什么研究是相关的。此外，鼓励但不需要讨论您调查该领域特定问题的个人动机。

    1. 项目背景信息
            该项目属于Udacity的毕业项目之一，按领域区分的话属于机器视觉，基本要求是对于一张输入图片，能够判断是猫还是狗，以及对应的概率。
    2. 历史信息
            图片分类有非常久远的历史信息，著名的ImageNet每年举办的视觉识别挑战赛是目前比较权威的图片分类领域的比赛，也是得到大家的广泛认可
            的，每年都会有来自全球的团队在这项比赛中应用他们的模型，到17年，参赛的39个团队已经有29个团队的错误率低于5%，这在该挑战赛中已经
            是非常优秀的成绩了，而其中大量使用的ResNet-50等模型都会是我们在该项目中参考、学习的优秀模型，当然了本项目相对于ImageNet的挑战赛
            要简单不少，但是原理都是一样的，通过模型对图片进行类别区分。
    3. 为什么要去解决，为什么能够解决
            计算机视觉在当今社会有非常多的应用场景，比如自动驾驶、婴幼儿护理、工业机器人、无人机、医疗影像等等，而解决猫狗分类问题本质上就是
            解决机器对事务的认知区分能力，这是一项原本属于人类的特有能力，对这一问题的解决可以延伸到所有计算机视觉的应用场景中。随着这些年
            算法的发展，ResNet-50、VGG19等模型的出现，硬件成本的降低，大数据在采集、传输、存储数据上的进步，使得图片分类这一人工智能问题的
            解决条件都已具备：1.源（大量的图片数据被采集、存储），2.方法（ResNet-50模型等的出现），3.成本（硬件成本的降低，摩尔定理）。
    4. 相关研究引用
            ResNet-50模型（何凯明博士，https://arxiv.org/abs/1512.03385）：深度残差网络，特点在于残差上，它的提出是CNN图像史
            上的一件里程碑事件。它的特殊性在于解决了深度网络的退化问题，15年的ImageNet挑战赛上使用了152层的网络，而相比较看，14年的VGG只有19层，
            从层数上看完全是碾压性的，因此错误率低是可以理解的，问题是它是如何解决深层网络难以训练的问题的呢，而关键就在于它架构上的残差学习，
            我们知道网络的深度对模型的性能至关重要，当增加网络层数后，网络可以进行更加复杂的特征模式的提取，所以当模型更深时理论上可以取得更好
            的结果。但是更深的网络其性能一定会更好吗？实验发现深度网络出现了退化问题（Degradation problem）：网络深度增加时，网络准确度出现饱和，
            甚至出现下降。而且已知这种退化并不是由于过拟合造成的，那么假设我们的每一层网络都是一个1*1的映射网络的话，不管怎么增加网络，网络的
            性能都会保持不变而不是退化，因此出现退化可能是我们的网络层的堆叠方式不对，而何博士根据这一点，提出了残差单元解决了深度网络的退化
            问题，大大的增加的网络的深度（据说已经到了1000层），且随着深度的增加，性能越来越好。
    5. 为什么相关
            何博士的RestNet深度残差网络的研究致力于解决神经网络过深导致得退化问题，而这在此之前，被退化问题困扰的CNN模型由于无法继续提高网络
            深度，在ImageNet的挑战赛中似乎已经达到了瓶颈，而所谓的深度神经网络，当时的GoogleNet也只有22层，似乎也称不上很深，而ResNet的出现
            则将网络的深度大大增加，同时不会出现退化问题，也大大增加了模型的抽象能力，对于我们的项目，在识别猫\狗时，更深的网络由于其更强的
            抽象能力，也能达到更好的效果；
    6. 做该项目的个人动机
            我大学时的毕业项目是一个简单的人脸识别，简单在于输入图片都是我自己定义好的，有非常严格的要求，基本就是一寸免冠照，而算法我记得是
            使用了KNN，用AdaBoost做的提升，最后的结果就是在自己定义好的测试机上效果很好，但是如果图片是用手机随便怕的，那简直惨不忍睹，现在
            想想，这个结果也算正常，而学习了Udacity的课程后，我发现有很多的算法可以做到更多的事，因此看到猫狗分类项目突然想到以前的事，后就
            决定做这个项目了。

    引用：
        1. https://blog.csdn.net/wspba/article/details/57074389
        2. https://arxiv.org/abs/1512.03385

### 问题描述
1段

在这一部分中，清楚地说明了要解决的问题。所描述的问题应该是明确定义的，并且应该至少有一个相关的潜在解决方案。此外，彻底描述问题，使得问题清晰地是可量化的（问题可以用数学或逻辑术语来表示）、可测量的（问题可以用一些度量标准度量并清楚地观察到）和可复制的（问题可以再现和occu）。RS不止一次。

    猫狗大战：以一张图片作为输入，经过基于ResNet的模型处理，返回是猫还是狗以及对应的概率作为输出。图片转换为三维张量输入模型，
    输出通过softmax给出具体概率值，模型基于ResNet-50，该模型网络结构相比较VGG等更深，抽象能力更强，在图片分类中的表现也更好，
    同时由于其残差单元的设计，避免了退化问题；

### 数据集和输入
2~3段

在本节中，应该彻底描述为项目考虑的数据集和/或输入，例如它们如何与问题相关以及为什么应该使用它们。如如何获得数据集或输入以及数据集或输入的特征等信息，应根据需要包括相关的参考文献和引文。应清楚数据集或输入将如何在项目中使用，以及它们的使用是否适当。考虑到问题的背景。

    本项目数据集来源于kaggle，数据本身是针对该项目收集的数据，所以可以使用他们来进行模型的
    训练，图片数据直接通过OpenCV读取，转换为三维的张量(长,宽,3),3表示RGB的三通道。通过获取
    图片对应的target做训练使用，切分数据为训练集、验证集，避免每次都需要提交到kaggle做模型
    验证。鉴于数据集来源于kaggle针对于该项目本身提供的，因此不存在数据不恰当的问题。

### 解决方案描述
1段

在这一节中，清楚地描述了一个解决问题的方法。该解决方案应适用于项目域，并适用于给定的数据集或输入。此外，要彻底描述解决方案，以便清楚地说明解决方案是可量化的（解决方案可以用数学或逻辑术语表示）、可测量的（解决方案可以通过某种度量进行测量并清楚地观察到）和可复制的（解决方案可以复制，以及发生不止一次）。

    基于TensorFlow实现ResNet-50网络实现猫狗分类，利用OpenCV读取图片，并通过Numpy转换为对应维度的张量数据，
    通过kaggle数据集对模型进行训练以及性能验证，验证指标使用准确率+概率双重标准，模型持久化到磁盘，设置
    随机seed保证结果可复制。

### 基准模型
1~2段

在本节中，提供与域、问题陈述和预期解决方案相关的基准模型或结果的细节。理想情况下，基准模型或结果将领域和给定问题中的现有方法或已知信息上下文化，然后可以将其与解决方案进行客观比较。详细描述基准测试模型或结果是如何可测量的（可以通过一些度量进行测量并清楚地观察）。

    基准模型选择恒判断为狗，且概率为100%，跟本项目选择的基于ResNet-50结构相比，ResNet-50在网络结构上更深，
    因此具有更好的抽象能力，对于图片数据的理解更强，分类效果更好，且不会出现深度网络可能
    出现的退化能力，同时结合正则、数据增强等处理，避免过拟合。基准模型的测量方式将与
    项目选择模型一致，准确率+概率的双重标准，因此最终的性能对比是建立在客观的基础上。

### 评价指标
1~2段

在本节中，提出至少一个可用于量化基准模型和解决方案模型的性能的评估度量。您建议的评估度量应该根据数据、问题说明和预期解决方案的上下文而适当。描述如何导出评价度量，并提供它们的数学表示的一个例子（如果适用的话）。复杂的评价指标应该是明确的和可量化的（可以用数学或逻辑术语表示）。

    使用准确率+概率的双重指标，其中优先考虑准确率，在正确分类的基础上加入分类概率来保证模型不仅能正确分类，
    而且对于分类的概率给予对应的奖励或惩罚。错误分类得分-1*分类概率，正确分类得分1*分类概率。

### 项目设计
1段

在最后一节中，总结了一个理论的工作流程，用于解决问题的解决方案。提供关于您可能考虑采用什么策略、在使用数据之前可能需要对数据进行什么分析、或者实现将考虑哪些算法的详细讨论。您提供的工作流和讨论应该与前面章节的质量一致。此外，还鼓励您包括小的可视化、伪代码或图表，以帮助描述项目设计，但不是必需的。讨论应该清楚地勾勒出您的CASTSITE项目的预期工作流程。

    1. 工作流程
        0. 图片数据读取转换为向量
        1. 数据预处理（图片向量数据与target）
        2. 数据切分（训练集、验证集）
        3. 构建模型（基于keras构建ResNet模型）
        4. 编译、加载模型
        5. 训练模型
        6. 通过性能指标验证模型性能
        7. 对比模型性能与基准模型性能
    2. 采用什么策略
        基于ResNet模型进行图片分类，性能指标使用准确率+分类概率方式。
    3. 需要对数据进行哪些前期分析
        由于数据源来自kaggle，而不是自己获取的，因此此处需要验证下数据的格式是否适合、与target是否对应即可。
    4. 算法是否有更详细的讨论
    5. 考虑包含小的可视化、伪代码、图表等信息来更好的描述项目设计
        1. 模型性能与基准模型性能的可视化比对。
        2. 图表展示模型训练、epochs等不同带来的影响。

## PS
在提交你的建议之前，问问你自己：
1. 你所写的建议是否遵循与项目模板相似的组织结构？
2. 每一部分（特别是解决方案和项目设计）都写得清晰、简洁、具体吗？是否有明确的术语或短语需要澄清？
3. 你的项目的听众能理解你的建议吗？
4. 你是否正确地校对了你的建议以保证语法和拼写错误最小？
5. 该项目的所有资源是否正确引用和引用？
